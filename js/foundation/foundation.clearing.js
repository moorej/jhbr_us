(function(c,b,a,d){Foundation.libs.clearing={name:"clearing",version:"4.3.2",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><img src="//:0"><p class="clearing-caption"></p><a href="#" class="clearing-main-prev"><span></span></a><a href="#" class="clearing-main-next"><span></span></a></div>'},close_selectors:".clearing-close",init:false,locked:false},init:function(g,h,f){var e=this;Foundation.inherit(this,"set_data get_data remove_data throttle data_options");if(typeof h==="object"){f=c.extend(true,this.settings,h)}if(typeof h!=="string"){c(this.scope).find("ul[data-clearing]").each(function(){var k=c(this),j=j||{},i=k.find("li"),l=e.get_data(k);if(!l&&i.length>0){j.$parent=k.parent();e.set_data(k,c.extend({},e.settings,j,e.data_options(k)));e.assemble(k.find("li"));if(!e.settings.init){e.events().swipe_events()}}});return this.settings.init}else{return this[h].call(this,f)}},events:function(){var e=this;c(this.scope).on("click.fndtn.clearing","ul[data-clearing] li",function(g,f,i){var f=f||c(this),i=i||f,k=f.next("li"),j=e.get_data(f.parent()),h=c(g.target);g.preventDefault();if(!j){e.init()}if(i.hasClass("visible")&&f[0]===i[0]&&k.length>0&&e.is_open(f)){i=k;h=i.find("img")}e.open(h,f,i);e.update_paddles(i)}).on("click.fndtn.clearing",".clearing-main-next",function(f){this.nav(f,"next")}.bind(this)).on("click.fndtn.clearing",".clearing-main-prev",function(f){this.nav(f,"prev")}.bind(this)).on("click.fndtn.clearing",this.settings.close_selectors,function(f){Foundation.libs.clearing.close(f,this)}).on("keydown.fndtn.clearing",function(f){this.keydown(f)}.bind(this));c(b).on("resize.fndtn.clearing",function(){this.resize()}.bind(this));this.settings.init=true;return this},swipe_events:function(){var e=this;c(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(g){if(!g.touches){g=g.originalEvent}var f={start_page_x:g.touches[0].pageX,start_page_y:g.touches[0].pageY,start_time:(new Date()).getTime(),delta_x:0,is_scrolling:d};c(this).data("swipe-transition",f);g.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(f){if(!f.touches){f=f.originalEvent}if(f.touches.length>1||f.scale&&f.scale!==1){return}var g=c(this).data("swipe-transition");if(typeof g==="undefined"){g={}}g.delta_x=f.touches[0].pageX-g.start_page_x;if(typeof g.is_scrolling==="undefined"){g.is_scrolling=!!(g.is_scrolling||Math.abs(g.delta_x)<Math.abs(f.touches[0].pageY-g.start_page_y))}if(!g.is_scrolling&&!g.active){f.preventDefault();var h=(g.delta_x<0)?"next":"prev";g.active=true;e.nav(f,h)}}).on("touchend.fndtn.clearing",".visible-img",function(f){c(this).data("swipe-transition",{});f.stopPropagation()})},assemble:function(h){var k=h.parent();k.after('<div id="foundationClearingHolder"></div>');var f=c("#foundationClearingHolder"),i=this.get_data(k),g=k.detach(),e={grid:'<div class="carousel">'+this.outerHTML(g[0])+"</div>",viewing:i.templates.viewing},j='<div class="clearing-assembled"><div>'+e.viewing+e.grid+"</div></div>";return f.after(j).remove()},open:function(i,h,f){var k=f.closest(".clearing-assembled"),j=k.find("div").first(),g=j.find(".visible-img"),e=g.find("img").not(i);if(!this.locked()){e.attr("src",this.load(i)).css("visibility","hidden");this.loaded(e,function(){e.css("visibility","visible");k.addClass("clearing-blackout");j.addClass("clearing-container");g.show();this.fix_height(f).caption(g.find(".clearing-caption"),i).center(e).shift(h,f,function(){f.siblings().removeClass("visible");f.addClass("visible")})}.bind(this))}},close:function(g,f){g.preventDefault();var i=(function(j){if(/blackout/.test(j.selector)){return j}else{return j.closest(".clearing-blackout")}}(c(f))),h,e;if(f===g.target&&i){h=i.find("div").first();e=h.find(".visible-img");this.settings.prev_index=0;i.find("ul[data-clearing]").attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout");h.removeClass("clearing-container");e.hide()}return false},is_open:function(e){return e.parent().prop("style").length>0},keydown:function(f){var e=c(".clearing-blackout").find("ul[data-clearing]");if(f.which===39){this.go(e,"next")}if(f.which===37){this.go(e,"prev")}if(f.which===27){c("a.clearing-close").trigger("click")}},nav:function(f,e){var g=c(".clearing-blackout").find("ul[data-clearing]");f.preventDefault();this.go(g,e)},resize:function(){var e=c(".clearing-blackout .visible-img").find("img");if(e.length){this.center(e)}},fix_height:function(f){var e=f.parent().children(),g=this;e.each(function(){var h=c(this),i=h.find("img");if(h.height()>g.outerHeight(i)){h.addClass("fix-height")}}).closest("ul").width(e.length*100+"%");return this},update_paddles:function(f){var e=f.closest(".carousel").siblings(".visible-img");if(f.next().length>0){e.find(".clearing-main-next").removeClass("disabled")}else{e.find(".clearing-main-next").addClass("disabled")}if(f.prev().length>0){e.find(".clearing-main-prev").removeClass("disabled")}else{e.find(".clearing-main-prev").addClass("disabled")}},center:function(e){if(!this.rtl){e.css({marginLeft:-(this.outerWidth(e)/2),marginTop:-(this.outerHeight(e)/2)})}else{e.css({marginRight:-(this.outerWidth(e)/2),marginTop:-(this.outerHeight(e)/2)})}return this},load:function(f){if(f[0].nodeName==="A"){var e=f.attr("href")}else{var e=f.parent().attr("href")}this.preload(f);if(e){return e}return f.attr("src")},preload:function(e){this.img(e.closest("li").next()).img(e.closest("li").prev())},loaded:function(g,h){function e(){h()}function f(){this.one("load",e);if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var j=this.attr("src"),i=j.match(/\?/)?"&":"?";i+="random="+(new Date()).getTime();this.attr("src",j+i)}}if(!g.attr("src")){e();return}if(g[0].complete||g[0].readyState===4){e()}else{f.call(g)}},img:function(g){if(g.length){var e=new Image(),f=g.find("a");if(f.length){e.src=f.attr("href")}else{e.src=g.find("img").attr("src")}}return this},caption:function(g,f){var e=f.data("caption");if(e){g.html(e).show()}else{g.text("").hide()}return this},go:function(e,h){var g=e.find(".visible"),f=g[h]();if(f.length){f.find("img").trigger("click",[g,f])}},shift:function(h,i,m){var j=i.parent(),g=this.settings.prev_index||i.index(),k=this.direction(j,h,i),f=parseInt(j.css("left"),10),e=this.outerWidth(i),l;if(i.index()!==g&&!/skip/.test(k)){if(/left/.test(k)){this.lock();j.animate({left:f+e},300,this.unlock())}else{if(/right/.test(k)){this.lock();j.animate({left:f-e},300,this.unlock())}}}else{if(/skip/.test(k)){l=i.index()-this.settings.up_count;this.lock();if(l>0){j.animate({left:-(l*e)},300,this.unlock())}else{j.animate({left:0},300,this.unlock())}}}m()},direction:function(g,f,l){var k=g.find("li"),j=this.outerWidth(k)+(this.outerWidth(k)/4),i=Math.floor(this.outerWidth(c(".clearing-container"))/j)-1,h=k.index(l),e;this.settings.up_count=i;if(this.adjacent(this.settings.prev_index,h)){if((h>i)&&h>this.settings.prev_index){e="right"}else{if((h>i-1)&&h<=this.settings.prev_index){e="left"}else{e=false}}}else{e="skip"}this.settings.prev_index=h;return e},adjacent:function(f,e){for(var g=e+1;g>=e-1;g--){if(g===f){return true}}return false},lock:function(){this.settings.locked=true},unlock:function(){this.settings.locked=false},locked:function(){return this.settings.locked},outerHTML:function(e){return e.outerHTML||new XMLSerializer().serializeToString(e)},off:function(){c(this.scope).off(".fndtn.clearing");c(b).off(".fndtn.clearing");this.remove_data();this.settings.init=false},reflow:function(){this.init()}}}(Foundation.zj,this,this.document));